{"ast":null,"code":"import _regeneratorRuntime from \"@babel/runtime-corejs2/regenerator\";\nimport _slicedToArray from \"@babel/runtime-corejs2/helpers/esm/slicedToArray\";\nimport _taggedTemplateLiteral from \"@babel/runtime-corejs2/helpers/esm/taggedTemplateLiteral\";\nimport React from \"react\";\nvar __jsx = React.createElement;\n\nfunction _templateObject3() {\n  var data = _taggedTemplateLiteral([\"\\n    query {\\n        scriptTags(first: 5) {\\n            edges {\\n                node {\\n                    id\\n                    src\\n                    displayScope\\n                }\\n            }\\n        }\\n    }\\n\"]);\n\n  _templateObject3 = function _templateObject3() {\n    return data;\n  };\n\n  return data;\n}\n\nfunction _templateObject2() {\n  var data = _taggedTemplateLiteral([\"\\n    mutation scriptTagDelete($id: ID!) {\\n        scriptTagDelete(id: $id) {\\n            deletedScriptTagId\\n            userErrors {\\n                field\\n                message\\n            }\\n        }\\n    }\\n\"]);\n\n  _templateObject2 = function _templateObject2() {\n    return data;\n  };\n\n  return data;\n}\n\nfunction _templateObject() {\n  var data = _taggedTemplateLiteral([\"\\n    mutation scriptTagCreate($input: ScriptTagInput!) {\\n        scriptTagCreate(input: $input) {\\n            scriptTag {\\n                id\\n            }\\n            userErrors {\\n                field\\n                message\\n            }\\n        }\\n    }       \\n\"]);\n\n  _templateObject = function _templateObject() {\n    return data;\n  };\n\n  return data;\n}\n\nimport gql from \"graphql-tag\";\nimport { useQuery, useMutation } from \"@apollo/react-hooks\";\nimport { Button, Card, Checkbox, ColorPicker, DatePicker, EmptyState, Layout, Page, RadioButton, ResourceList, Stack, TextField, Popover, RangeSlider } from \"@shopify/polaris\";\nimport { useCallback, useState } from \"react\";\nimport axios from 'axios';\nimport { TitleBar } from \"@shopify/app-bridge-react\";\nvar CREATE_SCRIPT_TAG = gql(_templateObject());\nvar DELETE_SCRIPT_TAG = gql(_templateObject2());\nvar QUERY_SCRIPTTAGS = gql(_templateObject3());\n\nvar Scripts = function Scripts() {\n  var _useMutation = useMutation(CREATE_SCRIPT_TAG),\n      _useMutation2 = _slicedToArray(_useMutation, 1),\n      createScript = _useMutation2[0];\n\n  var _useMutation3 = useMutation(DELETE_SCRIPT_TAG),\n      _useMutation4 = _slicedToArray(_useMutation3, 1),\n      deleteScript = _useMutation4[0];\n\n  var _useQuery = useQuery(QUERY_SCRIPTTAGS),\n      loading = _useQuery.loading,\n      error = _useQuery.error,\n      data = _useQuery.data;\n\n  var _useState = useState(false),\n      initBar = _useState[0],\n      setInitBar = _useState[1];\n\n  var _useState2 = useState(''),\n      name = _useState2[0],\n      setName = _useState2[1];\n\n  var _useState3 = useState({\n    month: 11,\n    year: 2019\n  }),\n      _useState3$ = _useState3[0],\n      month = _useState3$.month,\n      year = _useState3$.year,\n      setDate = _useState3[1];\n\n  var _useState4 = useState({\n    endMonth: 6,\n    endYear: 2020\n  }),\n      _useState4$ = _useState4[0],\n      endMonth = _useState4$.endMonth,\n      endYear = _useState4$.endYear,\n      setSecondDate = _useState4[1];\n\n  var _useState5 = useState({\n    start: new Date()\n  }),\n      selectedStartDate = _useState5[0],\n      setSelectedStartDate = _useState5[1];\n\n  var _useState6 = useState({\n    end: new Date('Wed Aug 08 2020 00:00:00 GMT-0300 (EST)')\n  }),\n      selectedEndDate = _useState6[0],\n      setSelectedEndDate = _useState6[1];\n\n  var handleMonthChange = useCallback(function (month, year) {\n    return setDate({\n      month: month,\n      year: year\n    });\n  }, []);\n  var handleEndMonthChange = useCallback(function (endMonth, endYear) {\n    return setSecondDate({\n      endMonth: endMonth,\n      endYear: endYear\n    });\n  }, []);\n\n  var _useState7 = useState('Top'),\n      value = _useState7[0],\n      setValue = _useState7[1];\n\n  var _useState8 = useState(false),\n      checked = _useState8[0],\n      setChecked = _useState8[1];\n\n  var _useState9 = useState('#41416A'),\n      bgColor = _useState9[0],\n      setBgColor = _useState9[1];\n\n  var _useState10 = useState('#ffffff'),\n      borderColor = _useState10[0],\n      setBorderColor = _useState10[1];\n\n  debugger;\n  var handleChange = useCallback(function (_checked, newValue) {\n    return setValue(newValue);\n  }, []);\n\n  var _useState11 = useState(true),\n      popoverActive = _useState11[0],\n      setPopoverActive = _useState11[1];\n\n  var _useState12 = useState(true),\n      borderPopover = _useState12[0],\n      setBorderPopover = _useState12[1];\n\n  var togglePopoverActive = useCallback(function () {\n    return setPopoverActive(function (popoverActive) {\n      return !popoverActive;\n    });\n  }, []);\n  var toggleBorderPopover = useCallback(function () {\n    return setBorderPopover(function (popoverActive) {\n      return !popoverActive;\n    });\n  }, []);\n\n  var activator = __jsx(Button, {\n    onClick: togglePopoverActive,\n    disclosure: true\n  }, \"Background color\");\n\n  var borderActivator = __jsx(Button, {\n    onClick: toggleBorderPopover,\n    disclosure: true\n  }, \"Border color\");\n\n  var _useState13 = useState(0),\n      rangeValue = _useState13[0],\n      setRangeValue = _useState13[1];\n\n  var handleRangeSliderChange = useCallback(function (value) {\n    return setRangeValue(value);\n  }, []);\n\n  var handleSubmit = function handleSubmit() {\n    var res;\n    return _regeneratorRuntime.async(function handleSubmit$(_context) {\n      while (1) {\n        switch (_context.prev = _context.next) {\n          case 0:\n            createScript({\n              variables: {\n                input: {\n                  src: \"https://46e37398.ngrok.io/script.js\",\n                  displayScope: \"ALL\"\n                },\n                refetchQueries: [{\n                  query: QUERY_SCRIPTTAGS\n                }]\n              }\n            });\n            _context.next = 3;\n            return _regeneratorRuntime.awrap(axios.post('https://46e37398.ngrok.io/api/scripts', {\n              name: name,\n              startDate: selectedStartDate,\n              endDate: selectedEndDate,\n              position: value,\n              sticky: checked,\n              backGroundColor: bgColor,\n              borderSize: rangeValue,\n              borderColor: borderColor\n            }));\n\n          case 3:\n            res = _context.sent;\n            console.log(res);\n            setInitBar(false);\n\n          case 6:\n          case \"end\":\n            return _context.stop();\n        }\n      }\n    });\n  };\n\n  var deleteSubmit = function deleteSubmit() {\n    deleteScript({\n      variables: {\n        id: data.scriptTags.edges[0].node.id,\n        refetchQueries: [{\n          query: QUERY_SCRIPTTAGS\n        }]\n      }\n    });\n    axios[\"delete\"]('https://46e37398.ngrok.io/api/scripts').then(function (res) {\n      console.log(res);\n    });\n  };\n\n  if (!!loading) return __jsx(\"h1\", null, \"LOADING...\");\n  if (!!error) return __jsx(\"div\", null, error.message);\n  return __jsx(Page, null, \" \", !initBar && __jsx(TitleBar, {\n    primaryAction: {\n      content: 'Save',\n      onAction: function onAction() {\n        handleSubmit();\n      }\n    }\n  }), !initBar && __jsx(Layout, null, !data.scriptTags.edges.length && __jsx(Layout.Section, null, __jsx(EmptyState, {\n    heading: \"Time Banner\",\n    image: 'https://sct.spur-i-t.com/img/icons/empty-state.svg'\n  }, __jsx(Button, {\n    primary: true,\n    size: \"slim\",\n    type: \"submit\",\n    onClick: function onClick() {\n      setInitBar(true);\n    }\n  }, \"Create Bar\"))), !!data.scriptTags.edges.length && __jsx(Layout.Section, null, __jsx(Card, {\n    title: \"Delete Timebar\",\n    sectioned: true\n  }, __jsx(Button, {\n    primary: true,\n    size: \"slim\",\n    type: \"submit\",\n    onClick: deleteSubmit\n  }, \"Delete Bar\")))), initBar && __jsx(Layout, null, __jsx(Layout.Section, null, __jsx(Card, {\n    title: 'Banner name:',\n    sectioned: true\n  }, __jsx(TextField, {\n    label: 'name',\n    value: name,\n    onChange: function onChange(value) {\n      setName(value);\n    }\n  })), __jsx(Card, {\n    title: 'Start time',\n    sectioned: true\n  }, __jsx(DatePicker, {\n    month: month,\n    year: year,\n    onChange: setSelectedStartDate,\n    onMonthChange: handleMonthChange,\n    selected: selectedStartDate\n  })), __jsx(Card, {\n    title: 'End Time',\n    sectioned: true\n  }, __jsx(DatePicker, {\n    month: endMonth,\n    year: endYear,\n    onChange: setSelectedEndDate,\n    onMonthChange: handleEndMonthChange,\n    selected: selectedEndDate,\n    size: 'slim'\n  })), __jsx(Card, {\n    title: 'Timer display',\n    sectioned: true\n  }, __jsx(Stack, {\n    vertical: true\n  }, __jsx(RadioButton, {\n    label: \"Top\",\n    helpText: \"Displays timer at the top of the store.\",\n    checked: value === 'Top',\n    id: 'Top',\n    name: \"Top\",\n    onChange: handleChange\n  }), __jsx(RadioButton, {\n    label: \"Bottom\",\n    helpText: \"Displays timer at the bottom of the store.\",\n    id: \"Bottom\",\n    name: \"Bottom\",\n    checked: value === 'Bottom',\n    onChange: handleChange\n  })), __jsx(Checkbox, {\n    label: \"Display sticky\",\n    checked: checked,\n    onChange: function onChange(newChecked) {\n      setChecked(newChecked);\n    }\n  })), __jsx(Card, {\n    title: 'Timer design',\n    sectioned: true\n  }, __jsx(\"div\", {\n    style: {\n      display: 'flex',\n      justifyContent: 'space-around',\n      width: '100%'\n    }\n  }, __jsx(\"div\", null, __jsx(\"p\", {\n    style: {\n      marginBottom: '10px'\n    }\n  }, \"Background color:\"), __jsx(Popover, {\n    active: popoverActive,\n    activator: activator,\n    onClose: togglePopoverActive,\n    fluidContent: true,\n    sectioned: true\n  }, __jsx(ColorPicker, {\n    color: bgColor,\n    onChange: setBgColor\n  }))), __jsx(\"div\", null, __jsx(RangeSlider, {\n    label: \"Border size:\",\n    value: rangeValue,\n    onChange: handleRangeSliderChange,\n    min: 0,\n    max: 12,\n    output: true\n  })), __jsx(\"div\", null, __jsx(\"p\", {\n    style: {\n      marginBottom: '10px'\n    }\n  }, \"Border color:\"), __jsx(Popover, {\n    active: borderPopover,\n    activator: borderActivator,\n    onClose: toggleBorderPopover,\n    fluidContent: true,\n    sectioned: true\n  }, __jsx(ColorPicker, {\n    color: borderColor,\n    onChange: setBorderColor\n  }))))), __jsx(\"div\", {\n    style: {\n      marginTop: '25px'\n    }\n  }, __jsx(Button, {\n    primary: true,\n    size: \"large\",\n    type: \"submit\",\n    onClick: handleSubmit\n  }, \"Save\")))));\n};\n\nexport default Scripts;","map":{"version":3,"sources":["D:/JSprojects/nextShopify/pages/scripts.js"],"names":["gql","useQuery","useMutation","Button","Card","Checkbox","ColorPicker","DatePicker","EmptyState","Layout","Page","RadioButton","ResourceList","Stack","TextField","Popover","RangeSlider","useCallback","useState","axios","TitleBar","CREATE_SCRIPT_TAG","DELETE_SCRIPT_TAG","QUERY_SCRIPTTAGS","Scripts","createScript","deleteScript","loading","error","data","initBar","setInitBar","name","setName","month","year","setDate","endMonth","endYear","setSecondDate","start","Date","selectedStartDate","setSelectedStartDate","end","selectedEndDate","setSelectedEndDate","handleMonthChange","handleEndMonthChange","value","setValue","checked","setChecked","bgColor","setBgColor","borderColor","setBorderColor","handleChange","_checked","newValue","popoverActive","setPopoverActive","borderPopover","setBorderPopover","togglePopoverActive","toggleBorderPopover","activator","borderActivator","rangeValue","setRangeValue","handleRangeSliderChange","handleSubmit","variables","input","src","displayScope","refetchQueries","query","post","startDate","endDate","position","sticky","backGroundColor","borderSize","res","console","log","deleteSubmit","id","scriptTags","edges","node","then","message","content","onAction","length","newChecked","display","justifyContent","width","marginBottom","marginTop"],"mappings":"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","sourcesContent":["import gql from \"graphql-tag\"\r\nimport {useQuery, useMutation} from \"@apollo/react-hooks\"\r\nimport {\r\n    Button,\r\n    Card, Checkbox, ColorPicker,\r\n    DatePicker,\r\n    EmptyState,\r\n    Layout,\r\n    Page,\r\n    RadioButton,\r\n    ResourceList, Stack,\r\n    TextField, Popover, RangeSlider\r\n} from \"@shopify/polaris\";\r\nimport {useCallback, useState} from \"react\";\r\nimport axios from 'axios'\r\nimport {TitleBar} from \"@shopify/app-bridge-react\";\r\n\r\nconst CREATE_SCRIPT_TAG = gql`\r\n    mutation scriptTagCreate($input: ScriptTagInput!) {\r\n        scriptTagCreate(input: $input) {\r\n            scriptTag {\r\n                id\r\n            }\r\n            userErrors {\r\n                field\r\n                message\r\n            }\r\n        }\r\n    }       \r\n`;\r\n\r\nconst DELETE_SCRIPT_TAG = gql`\r\n    mutation scriptTagDelete($id: ID!) {\r\n        scriptTagDelete(id: $id) {\r\n            deletedScriptTagId\r\n            userErrors {\r\n                field\r\n                message\r\n            }\r\n        }\r\n    }\r\n`;\r\n\r\nconst QUERY_SCRIPTTAGS = gql`\r\n    query {\r\n        scriptTags(first: 5) {\r\n            edges {\r\n                node {\r\n                    id\r\n                    src\r\n                    displayScope\r\n                }\r\n            }\r\n        }\r\n    }\r\n`;\r\n\r\nconst Scripts = () => {\r\n\r\n    const [createScript] = useMutation(CREATE_SCRIPT_TAG);\r\n    const [deleteScript] = useMutation(DELETE_SCRIPT_TAG);\r\n    const {loading, error, data} = useQuery(QUERY_SCRIPTTAGS);\r\n    const [initBar, setInitBar] = useState(false);\r\n    const [name, setName] = useState('');\r\n\r\n    const [{month, year}, setDate] = useState({\r\n        month: 11,\r\n        year: 2019,\r\n    });\r\n    const [{endMonth, endYear}, setSecondDate] = useState({\r\n        endMonth: 6,\r\n        endYear: 2020\r\n    });\r\n    const [selectedStartDate, setSelectedStartDate] = useState({\r\n        start: new Date(),\r\n    });\r\n    const [selectedEndDate, setSelectedEndDate] = useState({\r\n        end: new Date('Wed Aug 08 2020 00:00:00 GMT-0300 (EST)'),\r\n    });\r\n\r\n    const handleMonthChange = useCallback(\r\n        (month, year) => setDate({month, year}),\r\n        [],\r\n    );\r\n    const handleEndMonthChange = useCallback(\r\n        (endMonth, endYear) => setSecondDate({endMonth, endYear}),\r\n        [],\r\n    );\r\n\r\n    const [value, setValue] = useState('Top');\r\n    const [checked, setChecked] = useState(false);\r\n\r\n    const [bgColor, setBgColor] = useState('#41416A');\r\n    const [borderColor, setBorderColor] = useState('#ffffff');\r\n\r\n    debugger\r\n    const handleChange = useCallback(\r\n        (_checked, newValue) => setValue(newValue),\r\n        [],\r\n    );\r\n\r\n    const [popoverActive, setPopoverActive] = useState(true);\r\n    const [borderPopover, setBorderPopover] = useState(true);\r\n\r\n    const togglePopoverActive = useCallback(() => setPopoverActive(popoverActive => !popoverActive), []);\r\n    const toggleBorderPopover = useCallback(() => setBorderPopover(popoverActive => !popoverActive), []);\r\n    const activator = <Button onClick={togglePopoverActive} disclosure>\r\n        Background\r\n        color\r\n    </Button>;\r\n    const borderActivator = <Button onClick={toggleBorderPopover} disclosure>\r\n        Border color\r\n    </Button>;\r\n\r\n    const [rangeValue, setRangeValue] = useState(0);\r\n\r\n    const handleRangeSliderChange = useCallback(\r\n        (value) => setRangeValue(value),\r\n        [],\r\n    );\r\n\r\n    const handleSubmit = async () => {\r\n        createScript({\r\n            variables: {\r\n                input: {\r\n                    src: \"https://46e37398.ngrok.io/script.js\",\r\n                    displayScope: \"ALL\"\r\n                },\r\n                refetchQueries: [{query: QUERY_SCRIPTTAGS}]\r\n            }\r\n        });\r\n        let res = await axios.post('https://46e37398.ngrok.io/api/scripts',\r\n            {\r\n                name,\r\n                startDate: selectedStartDate,\r\n                endDate: selectedEndDate,\r\n                position: value,\r\n                sticky: checked,\r\n                backGroundColor: bgColor,\r\n                borderSize: rangeValue,\r\n                borderColor,\r\n            });\r\n        console.log(res);\r\n        setInitBar(false);\r\n    };\r\n\r\n    const deleteSubmit = () => {\r\n        deleteScript({\r\n            variables: {\r\n                id: data.scriptTags.edges[0].node.id,\r\n                refetchQueries: [{query: QUERY_SCRIPTTAGS}]\r\n            }\r\n        });\r\n        axios.delete('https://46e37398.ngrok.io/api/scripts').then(res => {console.log(res)})\r\n    };\r\n\r\n    if (!!loading) return <h1>LOADING...</h1>;\r\n    if (!!error) return <div>{error.message}</div>;\r\n\r\n    return (\r\n        <Page> {!initBar && <TitleBar primaryAction={{\r\n            content: 'Save',\r\n            onAction: () => {handleSubmit()}\r\n        }}/>}\r\n            {!initBar && <Layout>\r\n                {!(data.scriptTags.edges.length) && <Layout.Section>\r\n                    <EmptyState\r\n                        heading={\"Time Banner\"}\r\n                    image={'https://sct.spur-i-t.com/img/icons/empty-state.svg'}>\r\n                        <Button\r\n                            primary\r\n                            size={\"slim\"}\r\n                            type={\"submit\"}\r\n                            onClick={() => {\r\n                                setInitBar(true)\r\n                            }}\r\n                        >\r\n                            Create Bar\r\n                        </Button>\r\n                    </EmptyState>\r\n                </Layout.Section>}\r\n                {!!(data.scriptTags.edges.length) && <Layout.Section>\r\n                    <Card title={\"Delete Timebar\"} sectioned>\r\n                        <Button\r\n                            primary\r\n                            size={\"slim\"}\r\n                            type={\"submit\"}\r\n                            onClick={deleteSubmit}>\r\n                            Delete Bar\r\n                        </Button>\r\n                    </Card>\r\n                </Layout.Section>}\r\n            </Layout>}\r\n            {initBar && <Layout>\r\n                <Layout.Section>\r\n                    <Card title={'Banner name:'} sectioned>\r\n                        <TextField\r\n                            label={'name'}\r\n                            value={name}\r\n                            onChange={(value) => {setName(value)}}\r\n                        />\r\n                    </Card>\r\n                    <Card title={'Start time'} sectioned>\r\n                        <DatePicker\r\n                            month={month}\r\n                            year={year}\r\n                            onChange={setSelectedStartDate}\r\n                            onMonthChange={handleMonthChange}\r\n                            selected={selectedStartDate}\r\n                        />\r\n                    </Card>\r\n                    <Card title={'End Time'} sectioned>\r\n                        <DatePicker\r\n                            month={endMonth}\r\n                            year={endYear}\r\n                            onChange={setSelectedEndDate}\r\n                            onMonthChange={handleEndMonthChange}\r\n                            selected={selectedEndDate}\r\n                            size={'slim'}\r\n                        />\r\n                    </Card>\r\n                    <Card title={'Timer display'} sectioned>\r\n                        <Stack vertical>\r\n                            <RadioButton\r\n                                label=\"Top\"\r\n                                helpText=\"Displays timer at the top of the store.\"\r\n                                checked={value === 'Top'}\r\n                                id={'Top'}\r\n                                name=\"Top\"\r\n                                onChange={handleChange}\r\n                            />\r\n                            <RadioButton\r\n                                label=\"Bottom\"\r\n                                helpText=\"Displays timer at the bottom of the store.\"\r\n                                id=\"Bottom\"\r\n                                name=\"Bottom\"\r\n                                checked={value === 'Bottom'}\r\n                                onChange={handleChange}\r\n                            />\r\n                        </Stack>\r\n                        <Checkbox\r\n                            label=\"Display sticky\"\r\n                            checked={checked}\r\n                            onChange={(newChecked) => {setChecked(newChecked)}}\r\n                        />\r\n                    </Card>\r\n                    <Card title={'Timer design'} sectioned>\r\n                        <div style={{display: 'flex', justifyContent:'space-around',width: '100%'}}>\r\n                        <div>\r\n                        <p style={{marginBottom: '10px'}}>Background color:</p>\r\n\r\n                        <Popover active={popoverActive} activator={activator} onClose={togglePopoverActive}\r\n                                 fluidContent={true} sectioned>\r\n                            <ColorPicker color={bgColor} onChange={setBgColor}/>\r\n                        </Popover>\r\n                        </div>\r\n                            <div>\r\n                                <RangeSlider\r\n                                    label=\"Border size:\"\r\n                                    value={rangeValue}\r\n                                    onChange={handleRangeSliderChange}\r\n                                    min={0}\r\n                                    max={12}\r\n                                    output\r\n                                />\r\n                            </div>\r\n                            <div>\r\n                                <p style={{marginBottom: '10px'}}>Border color:</p>\r\n\r\n                                <Popover active={borderPopover} activator={borderActivator} onClose={toggleBorderPopover}\r\n                                         fluidContent={true} sectioned>\r\n                                    <ColorPicker color={borderColor} onChange={setBorderColor}/>\r\n                                </Popover>\r\n                            </div>\r\n                        </div>\r\n                    </Card>\r\n                    <div style={{marginTop: '25px'}}>\r\n                    <Button\r\n                        primary\r\n                        size={\"large\"}\r\n                        type={\"submit\"}\r\n                        onClick={handleSubmit}\r\n                    >\r\n                        Save\r\n                    </Button>\r\n                    </div>\r\n                </Layout.Section>\r\n            </Layout>}\r\n        </Page>\r\n    )\r\n};\r\n\r\nexport default Scripts"]},"metadata":{},"sourceType":"module"}