{"ast":null,"code":"import React from \"react\";\nvar __jsx = React.createElement;\nimport gql from \"graphql-tag\";\nimport { useQuery, useMutation } from \"@apollo/react-hooks\";\nimport { Button, Card, Checkbox, ColorPicker, DatePicker, EmptyState, Layout, Page, InlineError, RadioButton, ResourceList, Stack, TextField, Popover, RangeSlider } from \"@shopify/polaris\";\nimport { useCallback, useState, useEffect } from \"react\";\nimport Link from 'next/link';\nimport axios from 'axios';\nconst CREATE_SCRIPT_TAG = gql`\n    mutation scriptTagCreate($input: ScriptTagInput!) {\n        scriptTagCreate(input: $input) {\n            scriptTag {\n                id\n            }\n            userErrors {\n                field\n                message\n            }\n        }\n    }       \n`;\nconst DELETE_SCRIPT_TAG = gql`\n    mutation scriptTagDelete($id: ID!) {\n        scriptTagDelete(id: $id) {\n            deletedScriptTagId\n            userErrors {\n                field\n                message\n            }\n        }\n    }\n`;\nconst QUERY_SCRIPTTAGS = gql`\n    query {\n        scriptTags(first: 5) {\n            edges {\n                node {\n                    id\n                    src\n                    displayScope\n                }\n            }\n        }\n    }\n`;\n\nconst Initial = () => {\n  useEffect(() => {\n    const fetchData = async () => {\n      let res = await axios.get('https://d7fc8e16.ngrok.io/api/scripts');\n      debugger;\n      return res.data;\n    };\n\n    fetchConfig(fetchData());\n  }, []);\n  const {\n    0: config,\n    1: fetchConfig\n  } = useState(false);\n  const [createScript] = useMutation(CREATE_SCRIPT_TAG);\n  const [deleteScript] = useMutation(DELETE_SCRIPT_TAG);\n  const {\n    loading,\n    error,\n    data\n  } = useQuery(QUERY_SCRIPTTAGS);\n  const {\n    0: initBar,\n    1: setInitBar\n  } = useState(false);\n  const {\n    0: name,\n    1: setName\n  } = useState('Timer');\n  const {\n    0: {\n      month,\n      year\n    },\n    1: setDate\n  } = useState({\n    month: 4,\n    year: 2020\n  });\n  const {\n    0: {\n      endMonth,\n      endYear\n    },\n    1: setSecondDate\n  } = useState({\n    endMonth: 6,\n    endYear: 2020\n  });\n  const {\n    0: selectedStartDate,\n    1: setSelectedStartDate\n  } = useState({\n    start: new Date()\n  });\n  const {\n    0: selectedEndDate,\n    1: setSelectedEndDate\n  } = useState({\n    end: new Date('Wed Aug 08 2020 00:00:00 GMT-0300 (EST)')\n  });\n  const handleMonthChange = useCallback((month, year) => setDate({\n    month,\n    year\n  }), []);\n  const handleEndMonthChange = useCallback((endMonth, endYear) => setSecondDate({\n    endMonth,\n    endYear\n  }), []);\n  const {\n    0: value,\n    1: setValue\n  } = useState('Top');\n  const {\n    0: checked,\n    1: setChecked\n  } = useState(false);\n  const {\n    0: bgColor,\n    1: setBgColor\n  } = useState({\n    hue: 1,\n    saturation: 1,\n    brightness: 1,\n    alpha: 1\n  });\n  const {\n    0: borderColor,\n    1: setBorderColor\n  } = useState({\n    hue: 1,\n    saturation: 1,\n    brightness: 1,\n    alpha: 1\n  });\n  const handleChange = useCallback((_checked, newValue) => setValue(newValue), []);\n  const {\n    0: popoverActive,\n    1: setPopoverActive\n  } = useState(true);\n  const {\n    0: borderPopover,\n    1: setBorderPopover\n  } = useState(true);\n  const togglePopoverActive = useCallback(() => setPopoverActive(popoverActive => !popoverActive), []);\n  const toggleBorderPopover = useCallback(() => setBorderPopover(popoverActive => !popoverActive), []);\n\n  const activator = __jsx(Button, {\n    onClick: togglePopoverActive,\n    disclosure: true\n  }, \"Background color\");\n\n  const borderActivator = __jsx(Button, {\n    onClick: toggleBorderPopover,\n    disclosure: true\n  }, \"Border color\");\n\n  const {\n    0: rangeValue,\n    1: setRangeValue\n  } = useState(0);\n  const handleRangeSliderChange = useCallback(value => setRangeValue(value), []);\n\n  const handleSubmit = async () => {\n    createScript({\n      variables: {\n        input: {\n          src: \"https://d7fc8e16.ngrok.io/script.js\",\n          displayScope: \"ALL\"\n        },\n        refetchQueries: [{\n          query: QUERY_SCRIPTTAGS\n        }]\n      }\n    });\n    let res = await axios.post('https://d7fc8e16.ngrok.io/api/scripts', {\n      name,\n      startDate: selectedStartDate,\n      endDate: selectedEndDate,\n      position: value,\n      sticky: checked,\n      backGroundColor: bgColor,\n      borderSize: rangeValue,\n      borderColor\n    });\n    console.log(res);\n  };\n\n  const deleteSubmit = () => {\n    deleteScript({\n      variables: {\n        id: data.scriptTags.edges[0].node.id,\n        refetchQueries: [{\n          query: QUERY_SCRIPTTAGS\n        }]\n      }\n    });\n    axios.delete('https://d7fc8e16.ngrok.io/api/scripts').then(res => {\n      console.log(res);\n    });\n  };\n\n  if (!!loading) return __jsx(\"div\", {\n    style: {\n      display: 'flex',\n      justifyContent: 'center',\n      alignItems: 'center',\n      width: '100%',\n      height: '100%',\n      fontSize: '30px',\n      fontWeight: '700'\n    }\n  }, \"LOADING...\");\n  if (!!error) return __jsx(\"div\", null, error.message);\n  debugger;\n  return __jsx(Page, null, !initBar && __jsx(Layout, null, !data.scriptTags.edges.length && __jsx(Layout.Section, null, __jsx(EmptyState, {\n    heading: \"Sale Banner\",\n    image: 'https://sct.spur-i-t.com/img/icons/empty-state.svg'\n  }, __jsx(Button, {\n    primary: true,\n    size: \"slim\",\n    type: \"submit\",\n    onClick: () => {\n      setInitBar(true);\n    }\n  }, \"Create Banner\"))), !!data.scriptTags.edges.length && __jsx(Layout.Section, null, __jsx(Card, {\n    title: \"Existing Banner:\",\n    sectioned: true\n  }, __jsx(\"p\", null, config.data ? config.data.name : \"\"), __jsx(Button, {\n    primary: true,\n    size: \"slim\",\n    type: \"submit\",\n    onClick: deleteSubmit\n  }, \"Delete Banner\")))), initBar && __jsx(Layout, null, __jsx(Layout.Section, null, __jsx(Card, {\n    title: 'Banner name:',\n    sectioned: true\n  }, __jsx(TextField, {\n    label: 'Name',\n    value: name,\n    onChange: value => {\n      setName(value);\n    },\n    error: !name ? 'Please enter name' : ''\n  })), __jsx(Card, {\n    title: 'Start time',\n    sectioned: true\n  }, __jsx(DatePicker, {\n    month: month,\n    year: year,\n    onChange: setSelectedStartDate,\n    onMonthChange: handleMonthChange,\n    selected: selectedStartDate\n  })), __jsx(Card, {\n    title: 'End Time',\n    sectioned: true\n  }, __jsx(DatePicker, {\n    month: endMonth,\n    year: endYear,\n    onChange: setSelectedEndDate,\n    onMonthChange: handleEndMonthChange,\n    selected: selectedEndDate,\n    size: 'slim'\n  })), __jsx(Card, {\n    title: 'Timer display',\n    sectioned: true\n  }, __jsx(Stack, {\n    vertical: true\n  }, __jsx(RadioButton, {\n    label: \"Top\",\n    helpText: \"Displays timer at the top of the store.\",\n    checked: value === 'Top',\n    id: 'Top',\n    name: \"Top\",\n    onChange: handleChange\n  }), __jsx(RadioButton, {\n    label: \"Bottom\",\n    helpText: \"Displays timer at the bottom of the store.\",\n    id: \"Bottom\",\n    name: \"Bottom\",\n    checked: value === 'Bottom',\n    onChange: handleChange\n  })), __jsx(Checkbox, {\n    label: \"Display sticky\",\n    checked: checked,\n    onChange: newChecked => {\n      setChecked(newChecked);\n    }\n  })), __jsx(Card, {\n    title: 'Timer design',\n    sectioned: true\n  }, __jsx(\"div\", {\n    style: {\n      display: 'flex',\n      justifyContent: 'space-around',\n      width: '100%'\n    }\n  }, __jsx(\"div\", null, __jsx(\"p\", {\n    style: {\n      marginBottom: '10px'\n    }\n  }, \"Background color:\"), __jsx(Popover, {\n    active: popoverActive,\n    activator: activator,\n    onClose: togglePopoverActive,\n    fluidContent: true,\n    sectioned: true\n  }, __jsx(ColorPicker, {\n    color: bgColor,\n    onChange: setBgColor\n  })), __jsx(\"div\", {\n    style: {\n      width: '100%',\n      height: '40px',\n      borderRadius: '5px',\n      backgroundColor: `hsla(${bgColor.hue}, ${bgColor.saturation * 100}%, ${bgColor.brightness * 100}%, ${bgColor.alpha})`,\n      marginTop: '10px'\n    }\n  })), __jsx(\"div\", null, __jsx(RangeSlider, {\n    label: \"Border size:\",\n    value: rangeValue,\n    onChange: handleRangeSliderChange,\n    min: 0,\n    max: 12,\n    output: true\n  })), __jsx(\"div\", null, __jsx(\"p\", {\n    style: {\n      marginBottom: '10px'\n    }\n  }, \"Border color:\"), __jsx(Popover, {\n    active: borderPopover,\n    activator: borderActivator,\n    onClose: toggleBorderPopover,\n    fluidContent: true,\n    sectioned: true\n  }, __jsx(ColorPicker, {\n    color: borderColor,\n    onChange: setBorderColor\n  })), __jsx(\"div\", {\n    style: {\n      width: '100%',\n      height: '40px',\n      borderRadius: '5px',\n      backgroundColor: `hsla(${borderColor.hue}, ${borderColor.saturation * 100}%, ${borderColor.brightness * 100}%, ${borderColor.alpha})`,\n      marginTop: '10px'\n    }\n  })))), __jsx(\"div\", {\n    style: {\n      marginTop: '25px'\n    }\n  }, __jsx(Link, {\n    href: '/success'\n  }, __jsx(Button, {\n    primary: true,\n    size: \"large\",\n    type: \"submit\",\n    onClick: handleSubmit,\n    disabled: !name\n  }, \"Save\"))))));\n};\n\nexport default Initial;","map":{"version":3,"sources":["D:/JSprojects/nextShopify/pages/index.js"],"names":["gql","useQuery","useMutation","Button","Card","Checkbox","ColorPicker","DatePicker","EmptyState","Layout","Page","InlineError","RadioButton","ResourceList","Stack","TextField","Popover","RangeSlider","useCallback","useState","useEffect","Link","axios","CREATE_SCRIPT_TAG","DELETE_SCRIPT_TAG","QUERY_SCRIPTTAGS","Initial","fetchData","res","get","data","fetchConfig","config","createScript","deleteScript","loading","error","initBar","setInitBar","name","setName","month","year","setDate","endMonth","endYear","setSecondDate","selectedStartDate","setSelectedStartDate","start","Date","selectedEndDate","setSelectedEndDate","end","handleMonthChange","handleEndMonthChange","value","setValue","checked","setChecked","bgColor","setBgColor","hue","saturation","brightness","alpha","borderColor","setBorderColor","handleChange","_checked","newValue","popoverActive","setPopoverActive","borderPopover","setBorderPopover","togglePopoverActive","toggleBorderPopover","activator","borderActivator","rangeValue","setRangeValue","handleRangeSliderChange","handleSubmit","variables","input","src","displayScope","refetchQueries","query","post","startDate","endDate","position","sticky","backGroundColor","borderSize","console","log","deleteSubmit","id","scriptTags","edges","node","delete","then","display","justifyContent","alignItems","width","height","fontSize","fontWeight","message","length","newChecked","marginBottom","borderRadius","backgroundColor","marginTop"],"mappings":"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","sourcesContent":["import gql from \"graphql-tag\"\r\nimport {useQuery, useMutation} from \"@apollo/react-hooks\"\r\nimport {\r\n    Button,\r\n    Card, Checkbox, ColorPicker,\r\n    DatePicker,\r\n    EmptyState,\r\n    Layout,\r\n    Page, InlineError,\r\n    RadioButton,\r\n    ResourceList, Stack,\r\n    TextField, Popover, RangeSlider\r\n} from \"@shopify/polaris\";\r\nimport {useCallback, useState, useEffect} from \"react\";\r\nimport Link from 'next/link'\r\nimport axios from 'axios'\r\n\r\nconst CREATE_SCRIPT_TAG = gql`\r\n    mutation scriptTagCreate($input: ScriptTagInput!) {\r\n        scriptTagCreate(input: $input) {\r\n            scriptTag {\r\n                id\r\n            }\r\n            userErrors {\r\n                field\r\n                message\r\n            }\r\n        }\r\n    }       \r\n`;\r\n\r\nconst DELETE_SCRIPT_TAG = gql`\r\n    mutation scriptTagDelete($id: ID!) {\r\n        scriptTagDelete(id: $id) {\r\n            deletedScriptTagId\r\n            userErrors {\r\n                field\r\n                message\r\n            }\r\n        }\r\n    }\r\n`;\r\n\r\nconst QUERY_SCRIPTTAGS = gql`\r\n    query {\r\n        scriptTags(first: 5) {\r\n            edges {\r\n                node {\r\n                    id\r\n                    src\r\n                    displayScope\r\n                }\r\n            }\r\n        }\r\n    }\r\n`;\r\n\r\nconst Initial = () => {\r\n    useEffect(() => {\r\n        const fetchData = async () => {\r\n            let res = await axios.get('https://d7fc8e16.ngrok.io/api/scripts');\r\n            debugger\r\n            return res.data\r\n        };\r\n        fetchConfig(fetchData())\r\n    }, []);\r\n\r\n    const [config, fetchConfig] = useState(false);\r\n    const [createScript] = useMutation(CREATE_SCRIPT_TAG);\r\n    const [deleteScript] = useMutation(DELETE_SCRIPT_TAG);\r\n    const {loading, error, data} = useQuery(QUERY_SCRIPTTAGS);\r\n    const [initBar, setInitBar] = useState(false);\r\n    const [name, setName] = useState('Timer');\r\n\r\n    const [{month, year}, setDate] = useState({\r\n        month: 4,\r\n        year: 2020,\r\n    });\r\n    const [{endMonth, endYear}, setSecondDate] = useState({\r\n        endMonth: 6,\r\n        endYear: 2020\r\n    });\r\n    const [selectedStartDate, setSelectedStartDate] = useState({\r\n        start: new Date(),\r\n    });\r\n    const [selectedEndDate, setSelectedEndDate] = useState({\r\n        end: new Date('Wed Aug 08 2020 00:00:00 GMT-0300 (EST)'),\r\n    });\r\n\r\n    const handleMonthChange = useCallback(\r\n        (month, year) => setDate({month, year}),\r\n        [],\r\n    );\r\n    const handleEndMonthChange = useCallback(\r\n        (endMonth, endYear) => setSecondDate({endMonth, endYear}),\r\n        [],\r\n    );\r\n\r\n    const [value, setValue] = useState('Top');\r\n    const [checked, setChecked] = useState(false);\r\n\r\n    const [bgColor, setBgColor] = useState({\r\n        hue: 1,\r\n        saturation: 1,\r\n        brightness: 1,\r\n        alpha: 1\r\n    });\r\n    const [borderColor, setBorderColor] = useState({\r\n        hue: 1,\r\n        saturation: 1,\r\n        brightness: 1,\r\n        alpha: 1\r\n    });\r\n\r\n    const handleChange = useCallback(\r\n        (_checked, newValue) => setValue(newValue),\r\n        [],\r\n    );\r\n\r\n    const [popoverActive, setPopoverActive] = useState(true);\r\n    const [borderPopover, setBorderPopover] = useState(true);\r\n\r\n    const togglePopoverActive = useCallback(() => setPopoverActive(popoverActive => !popoverActive), []);\r\n    const toggleBorderPopover = useCallback(() => setBorderPopover(popoverActive => !popoverActive), []);\r\n    const activator = <Button onClick={togglePopoverActive} disclosure>\r\n        Background\r\n        color\r\n    </Button>;\r\n    const borderActivator = <Button onClick={toggleBorderPopover} disclosure>\r\n        Border color\r\n    </Button>;\r\n\r\n    const [rangeValue, setRangeValue] = useState(0);\r\n\r\n    const handleRangeSliderChange = useCallback(\r\n        (value) => setRangeValue(value),\r\n        [],\r\n    );\r\n\r\n    const handleSubmit = async () => {\r\n        createScript({\r\n            variables: {\r\n                input: {\r\n                    src: \"https://d7fc8e16.ngrok.io/script.js\",\r\n                    displayScope: \"ALL\"\r\n                },\r\n                refetchQueries: [{query: QUERY_SCRIPTTAGS}]\r\n            }\r\n        });\r\n        let res = await axios.post('https://d7fc8e16.ngrok.io/api/scripts',\r\n            {\r\n                name,\r\n                startDate: selectedStartDate,\r\n                endDate: selectedEndDate,\r\n                position: value,\r\n                sticky: checked,\r\n                backGroundColor: bgColor,\r\n                borderSize: rangeValue,\r\n                borderColor,\r\n            });\r\n        console.log(res);\r\n    };\r\n\r\n    const deleteSubmit = () => {\r\n        deleteScript({\r\n            variables: {\r\n                id: data.scriptTags.edges[0].node.id,\r\n                refetchQueries: [{query: QUERY_SCRIPTTAGS}]\r\n            }\r\n        });\r\n        axios.delete('https://d7fc8e16.ngrok.io/api/scripts').then(res => {console.log(res)})\r\n    };\r\n\r\n    if (!!loading) return <div style={{\r\n        display: 'flex',\r\n        justifyContent: 'center',\r\n        alignItems: 'center',\r\n        width: '100%',\r\n        height: '100%',\r\n        fontSize: '30px',\r\n        fontWeight: '700'\r\n    }}>LOADING...</div>;\r\n    if (!!error) return <div>{error.message}</div>;\r\ndebugger\r\n    return (\r\n        <Page>\r\n            {!initBar && <Layout>\r\n                {!(data.scriptTags.edges.length) && <Layout.Section>\r\n                    <EmptyState\r\n                        heading={\"Sale Banner\"}\r\n                        image={'https://sct.spur-i-t.com/img/icons/empty-state.svg'}>\r\n                        <Button\r\n                            primary\r\n                            size={\"slim\"}\r\n                            type={\"submit\"}\r\n                            onClick={() => {\r\n                                setInitBar(true)\r\n                            }}\r\n                        >\r\n                            Create Banner\r\n                        </Button>\r\n                    </EmptyState>\r\n                </Layout.Section>}\r\n                {!!(data.scriptTags.edges.length) && <Layout.Section>\r\n                    <Card title={\"Existing Banner:\"} sectioned>\r\n                        <p>{config.data?config.data.name:\"\"}</p>\r\n                        <Button\r\n                            primary\r\n                            size={\"slim\"}\r\n                            type={\"submit\"}\r\n                            onClick={deleteSubmit}>\r\n                            Delete Banner\r\n                        </Button>\r\n                    </Card>\r\n                </Layout.Section>}\r\n            </Layout>}\r\n            {initBar && <Layout>\r\n                <Layout.Section>\r\n                    <Card title={'Banner name:'} sectioned>\r\n                        <TextField\r\n                            label={'Name'}\r\n                            value={name}\r\n                            onChange={(value) => {setName(value)}}\r\n                            error={(!name)?'Please enter name':''}\r\n                        />\r\n                    </Card>\r\n                    <Card title={'Start time'} sectioned>\r\n                        <DatePicker\r\n                            month={month}\r\n                            year={year}\r\n                            onChange={setSelectedStartDate}\r\n                            onMonthChange={handleMonthChange}\r\n                            selected={selectedStartDate}\r\n                        />\r\n                    </Card>\r\n                    <Card title={'End Time'} sectioned>\r\n                        <DatePicker\r\n                            month={endMonth}\r\n                            year={endYear}\r\n                            onChange={setSelectedEndDate}\r\n                            onMonthChange={handleEndMonthChange}\r\n                            selected={selectedEndDate}\r\n                            size={'slim'}\r\n                        />\r\n                    </Card>\r\n                    <Card title={'Timer display'} sectioned>\r\n                        <Stack vertical>\r\n                            <RadioButton\r\n                                label=\"Top\"\r\n                                helpText=\"Displays timer at the top of the store.\"\r\n                                checked={value === 'Top'}\r\n                                id={'Top'}\r\n                                name=\"Top\"\r\n                                onChange={handleChange}\r\n                            />\r\n                            <RadioButton\r\n                                label=\"Bottom\"\r\n                                helpText=\"Displays timer at the bottom of the store.\"\r\n                                id=\"Bottom\"\r\n                                name=\"Bottom\"\r\n                                checked={value === 'Bottom'}\r\n                                onChange={handleChange}\r\n                            />\r\n                        </Stack>\r\n                        <Checkbox\r\n                            label=\"Display sticky\"\r\n                            checked={checked}\r\n                            onChange={(newChecked) => {setChecked(newChecked)}}\r\n                        />\r\n                    </Card>\r\n                    <Card title={'Timer design'} sectioned>\r\n                        <div style={{display: 'flex', justifyContent:'space-around',width: '100%'}}>\r\n                            <div>\r\n                                <p style={{marginBottom: '10px'}}>Background color:</p>\r\n\r\n                                <Popover active={popoverActive} activator={activator} onClose={togglePopoverActive}\r\n                                         fluidContent={true} sectioned>\r\n                                    <ColorPicker color={bgColor} onChange={setBgColor}/>\r\n                                </Popover>\r\n                                <div style={{width: '100%', height: '40px', borderRadius: '5px',\r\n                                    backgroundColor: `hsla(${bgColor.hue}, ${bgColor.saturation*100}%, ${bgColor.brightness*100}%, ${bgColor.alpha})`, marginTop: '10px'}}/>\r\n                            </div>\r\n                            <div>\r\n                                <RangeSlider\r\n                                    label=\"Border size:\"\r\n                                    value={rangeValue}\r\n                                    onChange={handleRangeSliderChange}\r\n                                    min={0}\r\n                                    max={12}\r\n                                    output\r\n                                />\r\n                            </div>\r\n                            <div>\r\n                                <p style={{marginBottom: '10px'}}>Border color:</p>\r\n\r\n                                <Popover active={borderPopover} activator={borderActivator} onClose={toggleBorderPopover}\r\n                                         fluidContent={true} sectioned>\r\n                                    <ColorPicker color={borderColor} onChange={setBorderColor}/>\r\n                                </Popover>\r\n                                <div style={{width: '100%', height: '40px', borderRadius: '5px',\r\n                                    backgroundColor: `hsla(${borderColor.hue}, ${borderColor.saturation*100}%, ${borderColor.brightness*100}%, ${borderColor.alpha})`, marginTop: '10px'}}/>\r\n                            </div>\r\n                        </div>\r\n                    </Card>\r\n                    <div style={{marginTop: '25px'}}>\r\n                        <Link href={'/success'}>\r\n                        <Button\r\n                            primary\r\n                            size={\"large\"}\r\n                            type={\"submit\"}\r\n                            onClick={handleSubmit}\r\n                            disabled={!name}\r\n                        >\r\n                            Save\r\n                        </Button>\r\n                        </Link>\r\n                    </div>\r\n                </Layout.Section>\r\n            </Layout>}\r\n        </Page>\r\n    )\r\n};\r\n\r\nexport default Initial\r\n"]},"metadata":{},"sourceType":"module"}